

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reference &mdash; kmos v0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="kmos v0.0.1 documentation" href="../index.html" />
    <link rel="next" title="Trouble Shooting" href="../troubleshooting/index.html" />
    <link rel="prev" title="The Site/Coordinate Syntax" href="../topic_guides/coord_syntax.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../troubleshooting/index.html" title="Trouble Shooting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../topic_guides/coord_syntax.html" title="The Site/Coordinate Syntax"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">kmos v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Reference</a><ul>
<li><a class="reference internal" href="#data-types">Data Types</a><ul>
<li><a class="reference internal" href="#module-kmos.types">kmos.types</a></li>
<li><a class="reference internal" href="#module-kmos.io">kmos.io</a></li>
</ul>
</li>
<li><a class="reference internal" href="#editor-frontend">Editor frontend</a><ul>
<li><a class="reference internal" href="#module-kmos.gui">kmos.gui</a></li>
<li><a class="reference internal" href="#module-kmos.forms">kmos.forms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#runtime-frontend">Runtime frontend</a><ul>
<li><a class="reference internal" href="#module-kmos.run">kmos.run</a></li>
<li><a class="reference internal" href="#module-kmos.view">kmos.view</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kmos-kmc-project-dtd">kmos kMC project DTD</a></li>
<li><a class="reference internal" href="#backend">Backend</a><ul>
<li><a class="reference internal" href="#kmos-base">kmos/base</a><ul>
<li><a class="reference internal" href="#base-accum-rates">base/accum_rates</a></li>
<li><a class="reference internal" href="#base-add-proc">base/add_proc</a></li>
<li><a class="reference internal" href="#base-allocate-system">base/allocate_system</a></li>
<li><a class="reference internal" href="#base-assertion-fail">base/assertion_fail</a></li>
<li><a class="reference internal" href="#base-avail-sites">base/avail_sites</a></li>
<li><a class="reference internal" href="#base-can-do">base/can_do</a></li>
<li><a class="reference internal" href="#base-deallocate-system">base/deallocate_system</a></li>
<li><a class="reference internal" href="#base-del-proc">base/del_proc</a></li>
<li><a class="reference internal" href="#base-determine-procsite">base/determine_procsite</a></li>
<li><a class="reference internal" href="#base-get-kmc-step">base/get_kmc_step</a></li>
<li><a class="reference internal" href="#base-get-kmc-time">base/get_kmc_time</a></li>
<li><a class="reference internal" href="#base-get-kmc-time-step">base/get_kmc_time_step</a></li>
<li><a class="reference internal" href="#base-get-kmc-volume">base/get_kmc_volume</a></li>
<li><a class="reference internal" href="#base-get-nrofsites">base/get_nrofsites</a></li>
<li><a class="reference internal" href="#base-get-procstat">base/get_procstat</a></li>
<li><a class="reference internal" href="#base-get-rate">base/get_rate</a></li>
<li><a class="reference internal" href="#base-get-species">base/get_species</a></li>
<li><a class="reference internal" href="#base-get-system-name">base/get_system_name</a></li>
<li><a class="reference internal" href="#base-get-walltime">base/get_walltime</a></li>
<li><a class="reference internal" href="#base-increment-procstat">base/increment_procstat</a></li>
<li><a class="reference internal" href="#base-interval-search-real">base/interval_search_real</a></li>
<li><a class="reference internal" href="#base-kmc-step">base/kmc_step</a></li>
<li><a class="reference internal" href="#base-kmc-time">base/kmc_time</a></li>
<li><a class="reference internal" href="#base-kmc-time-step">base/kmc_time_step</a></li>
<li><a class="reference internal" href="#base-lattice">base/lattice</a></li>
<li><a class="reference internal" href="#base-nr-of-proc">base/nr_of_proc</a></li>
<li><a class="reference internal" href="#base-nr-of-sites">base/nr_of_sites</a></li>
<li><a class="reference internal" href="#base-procstat">base/procstat</a></li>
<li><a class="reference internal" href="#base-rates">base/rates</a></li>
<li><a class="reference internal" href="#base-reload-system">base/reload_system</a></li>
<li><a class="reference internal" href="#base-replace-species">base/replace_species</a></li>
<li><a class="reference internal" href="#base-reset-site">base/reset_site</a></li>
<li><a class="reference internal" href="#base-save-system">base/save_system</a></li>
<li><a class="reference internal" href="#base-set-kmc-time">base/set_kmc_time</a></li>
<li><a class="reference internal" href="#base-set-rate-const">base/set_rate_const</a></li>
<li><a class="reference internal" href="#base-start-time">base/start_time</a></li>
<li><a class="reference internal" href="#base-system-name">base/system_name</a></li>
<li><a class="reference internal" href="#base-update-accum-rate">base/update_accum_rate</a></li>
<li><a class="reference internal" href="#base-update-clocks">base/update_clocks</a></li>
<li><a class="reference internal" href="#base-volume">base/volume</a></li>
<li><a class="reference internal" href="#base-walltime">base/walltime</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kmos-lattice">kmos/lattice</a><ul>
<li><a class="reference internal" href="#lattice-allocate-system">lattice/allocate_system</a></li>
<li><a class="reference internal" href="#lattice-calculate-lattice2nr">lattice/calculate_lattice2nr</a></li>
<li><a class="reference internal" href="#lattice-calculate-nr2lattice">lattice/calculate_nr2lattice</a></li>
<li><a class="reference internal" href="#lattice-deallocate-system">lattice/deallocate_system</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kmos-proclist">kmos/proclist</a><ul>
<li><a class="reference internal" href="#proclist-do-kmc-step">proclist/do_kmc_step</a></li>
<li><a class="reference internal" href="#proclist-get-kmc-step">proclist/get_kmc_step</a></li>
<li><a class="reference internal" href="#proclist-get-occupation">proclist/get_occupation</a></li>
<li><a class="reference internal" href="#proclist-init">proclist/init</a></li>
<li><a class="reference internal" href="#proclist-initialize-state">proclist/initialize_state</a></li>
<li><a class="reference internal" href="#proclist-run-proc-nr">proclist/run_proc_nr</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../topic_guides/coord_syntax.html"
                        title="previous chapter">The Site/Coordinate Syntax</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../troubleshooting/index.html"
                        title="next chapter">Trouble Shooting</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/reference/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-kmos.types">
<span id="kmos-types"></span><h3>kmos.types<a class="headerlink" href="#module-kmos.types" title="Permalink to this headline">¶</a></h3>
<p>Holds all the data models used in kmos.</p>
<dl class="class">
<dt id="kmos.types.Project">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Project</tt><a class="headerlink" href="#kmos.types.Project" title="Permalink to this definition">¶</a></dt>
<dd><p>A Project is where (almost) everything comes together.
A Project holds all other elements needed to describe one
kMC Project ready to be manipulated, exported, or imported.</p>
<p>The overall structure is the following as is also displayed
in the editor GUI.</p>
<p>Project:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">-</span> <span class="n">Meta</span>
<span class="o">-</span> <span class="n">Parameters</span>
<span class="o">-</span> <span class="n">Lattice</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Species</span>
<span class="o">-</span> <span class="n">Processes</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="kmos.types.Project.export_xml_file">
<tt class="descclassname">Project.</tt><tt class="descname">export_xml_file</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#kmos.types.Project.export_xml_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="kmos.types.Meta">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Meta</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Class holding the meta-information about the kMC project</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Parameter">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Parameter</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>A parameter that can be used in a rate constant expression
and defined via some init file</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Layer">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Layer</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents one layer in a possibly multi-layer geometry</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Site">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Site</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Site" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents one lattice site.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Species">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Species</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Species" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that represent a species such as oxygen, empty, ... .
Note: <cite>empty</cite> is treated just like a species.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">Species</span><span class="p">;</span> <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">attributes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Process">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Process</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Process" title="Permalink to this definition">¶</a></dt>
<dd><p>One process in a kMC process list</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.ConditionAction">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">ConditionAction</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.ConditionAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents either a condition or an action. Since both
have the same attributes we use the same class here, and just
store them in different lists, depending on its role.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.types.Coord">
<em class="property">class </em><tt class="descclassname">kmos.types.</tt><tt class="descname">Coord</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kmos.types.Coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that holds exactly one coordinate as used in the description
of a process. The distinction between a Coord and a Site may seem
superfluous but it is made to avoid data duplication.</p>
</dd></dl>

</div>
<div class="section" id="module-kmos.io">
<span id="kmos-io"></span><h3>kmos.io<a class="headerlink" href="#module-kmos.io" title="Permalink to this headline">¶</a></h3>
<p>Features front-end import/export functions for kMC Projects.
Currently import and export is supported to XML and export is
supported to Fortran 90 source code.</p>
<dl class="function">
<dt id="kmos.io.export_source">
<tt class="descclassname">kmos.io.</tt><tt class="descname">export_source</tt><big>(</big><em>project_tree</em>, <em>export_dir=None</em><big>)</big><a class="headerlink" href="#kmos.io.export_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Export a kmos project into Fortran 90 code that can be readily
compiled using f2py.  The model contained in project_tree
will be stored under the directory export_dir. export_dir will
be created if it does not exist. The XML representation of the
model will be included in the kmc_settings.py module.</p>
</dd></dl>

<dl class="function">
<dt id="kmos.io.import_xml">
<tt class="descclassname">kmos.io.</tt><tt class="descname">import_xml</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#kmos.io.import_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports and returns project from an XML file.</p>
</dd></dl>

<dl class="function">
<dt id="kmos.io.export_xml">
<tt class="descclassname">kmos.io.</tt><tt class="descname">export_xml</tt><big>(</big><em>project_tree</em>, <em>filename=None</em><big>)</big><a class="headerlink" href="#kmos.io.export_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a project to an XML file.</p>
</dd></dl>

</div>
</div>
<div class="section" id="editor-frontend">
<h2>Editor frontend<a class="headerlink" href="#editor-frontend" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-kmos.gui">
<span id="kmos-gui"></span><h3>kmos.gui<a class="headerlink" href="#module-kmos.gui" title="Permalink to this headline">¶</a></h3>
<p>A GUI frontend to create and edit kMC models.</p>
<dl class="class">
<dt id="kmos.gui.Editor">
<em class="property">class </em><tt class="descclassname">kmos.gui.</tt><tt class="descname">Editor</tt><a class="headerlink" href="#kmos.gui.Editor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="kmos.gui.GTKProject">
<em class="property">class </em><tt class="descclassname">kmos.gui.</tt><tt class="descname">GTKProject</tt><big>(</big><em>parent</em>, <em>menubar</em><big>)</big><a class="headerlink" href="#kmos.gui.GTKProject" title="Permalink to this definition">¶</a></dt>
<dd><p>A facade of kmos.types.Project so that
pygtk can display in a TreeView.</p>
</dd></dl>

</div>
<div class="section" id="module-kmos.forms">
<span id="kmos-forms"></span><h3>kmos.forms<a class="headerlink" href="#module-kmos.forms" title="Permalink to this headline">¶</a></h3>
<p>kmos.forms - GUI forms used by kmos.gui
The classes defined here heavily draw on the interface provided by
python-kiwi.
In the language of underlying MVC (Model-View-Controller) pattern these
classes form the controller. The view is defined through a <em>.glade XML file
and the models are instances of kmos.types.</em></p>
<dl class="class">
<dt id="kmos.forms.MetaForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">MetaForm</tt><big>(</big><em>model</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.MetaForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to enter meta information about the project.
Please enter author and email so people can credit you for the model.</p>
<p>Increasing the debug level makes the kmos backed create a lot of
output but is typically not needed.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.SpeciesListForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">SpeciesListForm</tt><big>(</big><em>model</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.SpeciesListForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to set the default species, <cite>i. e.</cite> the
system will be globally initialized with this species if
nothing else is set on a per site basis.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.SpeciesForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">SpeciesForm</tt><big>(</big><em>model</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.SpeciesForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to define a new species. Required attribute is name. The
chosen color will only shop up in the process editor. So choose something
you will remember and recognize.
The representation string is meant to be a ASE ase.atoms.Atoms constructor
that will show up in the ASE visualization.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.ParameterForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">ParameterForm</tt><big>(</big><em>model</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.ParameterForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to set parameter. These
parameters can be used in e.g. Transition State Theory
formula to calculate rate constants.</p>
<p>If &#8216;adjustable&#8217; is activated then they maybe be changed via
the <cite>kmos view</cite> front end while watching the model run.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.LatticeForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">LatticeForm</tt><big>(</big><em>model</em>, <em>dimension</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.LatticeForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to set global lattice parameter such as the lattice vector,
a ASE representation string, and the default layer. The program will
be initialized using the default layer.</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.LayerEditor">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">LayerEditor</tt><big>(</big><em>model</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.LayerEditor" title="Permalink to this definition">¶</a></dt>
<dd><p>Widget to define a lattice through the sites
in the unit cell (i.e. the <cite>basis</cite> in solid state language).</p>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.SiteForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">SiteForm</tt><big>(</big><em>site</em>, <em>parent</em>, <em>project_tree</em>, <em>layer</em><big>)</big><a class="headerlink" href="#kmos.forms.SiteForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to create or modify a site when setting up a unit cell.</p>
<dl class="method">
<dt id="kmos.forms.SiteForm.on_site_cancel__clicked">
<tt class="descname">on_site_cancel__clicked</tt><big>(</big><em>_</em><big>)</big><a class="headerlink" href="#kmos.forms.SiteForm.on_site_cancel__clicked" title="Permalink to this definition">¶</a></dt>
<dd><p>If we click cancel revert to previous state
or don&#8217;t add site, if new.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.forms.SiteForm.on_site_name__validate">
<tt class="descname">on_site_name__validate</tt><big>(</big><em>widget</em>, <em>site_name</em><big>)</big><a class="headerlink" href="#kmos.forms.SiteForm.on_site_name__validate" title="Permalink to this definition">¶</a></dt>
<dd><p>check if other site already has the name</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="kmos.forms.ProcessForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">ProcessForm</tt><big>(</big><em>process</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.ProcessForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to create and manipulate a process by dragging
species onto respective sites. The the lower species
represents a condition the upper one an action.</p>
<p>Rate constants can be entered directly using all defined parameters.
The tooltip shows the current value if all is entered correctly.</p>
<dl class="method">
<dt id="kmos.forms.ProcessForm.draw_from_data">
<tt class="descname">draw_from_data</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.forms.ProcessForm.draw_from_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Places circles on the current lattice according
to the conditions and actions defined</p>
</dd></dl>

<dl class="method">
<dt id="kmos.forms.ProcessForm.on_lattice">
<tt class="descname">on_lattice</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#kmos.forms.ProcessForm.on_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if (x, y) is in lattice box</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kmos.forms.parse_chemical_expression">
<tt class="descclassname">kmos.forms.</tt><tt class="descname">parse_chemical_expression</tt><big>(</big><em>eq</em>, <em>process</em>, <em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.parse_chemical_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates a chemical expression &#8216;eq&#8217; and adds
conditions and actions accordingly. Rules are:</p>
<blockquote>
<ul>
<li><dl class="first docutils">
<dt>each chemical expression has the form</dt>
<dd><p class="first last">conditions -&gt; actions</p>
</dd>
</dl>
</li>
<li><p class="first">each condition or action term has the form (regex)
[$^]*SPECIES&#64;SITE.OFFSET.LAYER</p>
</li>
<li><p class="first">each SPECIES must have been defined before. The special
species &#8216;empty&#8217; exists by default</p>
</li>
<li><p class="first">each SITE must have been defined before via the
layer form</p>
</li>
<li><p class="first">an offset in units of units cell can be given as
tuple such as &#8216;(0,0)&#8217;</p>
</li>
<li><p class="first">a condition or action term containing the default species,
i.e. by default &#8216;empty&#8217; may be omitted. However a term containing
the omitted site and a species other then the default must exist
on the opposite side of the expression</p>
</li>
<li><p class="first">^ and $ are special prefixes for the &#8216;creation&#8217; and
&#8216;annihilation&#8217; of a site, respectively. In case of &#8216;$&#8217;</p>
<blockquote>
<p>the species can be always omitted. In case of ^ the default
species may be omitted. Creation and annihilation is only
needed for lattice reconstructions/multi-lattice models and
they only stand on the right-hand (i.e. action) side of
the expression</p>
</blockquote>
</li>
<li><p class="first">white spaces may be used for readability but have no effect</p>
</li>
</ul>
</blockquote>
<dl class="docutils">
<dt>Examples::</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="mailto:oxygen&#37;&#52;&#48;cus">oxygen<span>&#64;</span>cus</a> -&gt; <a class="reference external" href="mailto:oxygen&#37;&#52;&#48;bridge">oxygen<span>&#64;</span>bridge</a> #diffusion</li>
<li><a class="reference external" href="mailto:co&#37;&#52;&#48;bridge">co<span>&#64;</span>bridge</a> -&gt; <a class="reference external" href="mailto:co&#37;&#52;&#48;cus">co<span>&#64;</span>cus</a>.(-1,0) # diffusion</li>
<li>-&gt; <a class="reference external" href="mailto:oxygen&#37;&#52;&#48;cus">oxygen<span>&#64;</span>cus</a> + <a class="reference external" href="mailto:oxygen&#37;&#52;&#48;bridge">oxygen<span>&#64;</span>bridge</a> # adsorption</li>
<li><a class="reference external" href="mailto:oxygen&#37;&#52;&#48;cus">oxygen<span>&#64;</span>cus</a> + <a class="reference external" href="mailto:co&#37;&#52;&#48;bridge">co<span>&#64;</span>bridge</a> -&gt; # reaction</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="kmos.forms.BatchProcessForm">
<em class="property">class </em><tt class="descclassname">kmos.forms.</tt><tt class="descname">BatchProcessForm</tt><big>(</big><em>project_tree</em><big>)</big><a class="headerlink" href="#kmos.forms.BatchProcessForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to enter many processes at once. The format is one
process per line in the form:</p>
<div class="highlight-python"><pre>[process name] ; [chemical expression] ; [rate constant]</pre>
</div>
<p>One can omit the fields but not the semicolon.</p>
</dd></dl>

</div>
</div>
<div class="section" id="runtime-frontend">
<h2>Runtime frontend<a class="headerlink" href="#runtime-frontend" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-kmos.run">
<span id="kmos-run"></span><h3>kmos.run<a class="headerlink" href="#module-kmos.run" title="Permalink to this headline">¶</a></h3>
<p>A front-end module to run a compiled kMC model. The actual model is
imported in kmc_model.so and all parameters are stored in kmc_settings.py.</p>
<p>The model can be used directly like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">kmos.model</span> <span class="kn">import</span> <span class="n">KMC_Model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KMC_Model</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">model</span><span class="o">.</span><span class="n">do_steps</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<p>which, of course can also be part of a python script.</p>
<p>The model can also be run in a different process using the
multiprocessing module. This mode is designed for use with
a GUI so that the CPU intensive kMC integration can run at
full throttle without impeding the front-end. Interaction with
the model happens through Queues.</p>
<dl class="class">
<dt id="kmos.run.KMC_Model">
<em class="property">class </em><tt class="descclassname">kmos.run.</tt><tt class="descname">KMC_Model</tt><big>(</big><em>image_queue=None</em>, <em>parameter_queue=None</em>, <em>signal_queue=None</em>, <em>size=None</em>, <em>system_name='kmc_model'</em>, <em>banner=True</em>, <em>print_rates=True</em>, <em>autosend=True</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>API Front-end to initialize and run a kMC model using python bindings.
Depending on the constructor cal the model can be run either via directory
calls or in a separate processes access via multiprocessing.Queues.
Only one model instance can exist simultaneously per process.</p>
<dl class="method">
<dt id="kmos.run.KMC_Model.deallocate">
<tt class="descname">deallocate</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.deallocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Deallocate all arrays that are allocated
by the Fortran module. This needs to be called
whenever more than one simulation is started
from one process.</p>
<p>Note that the currenty state and history of
the system is lost after calling this method.</p>
<p>Note: explicit invocation was chosen over the
__del__ method because there seems to easy
portable way to control garbage collection.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.do_steps">
<tt class="descname">do_steps</tt><big>(</big><em>n=10000</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.do_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate the model <cite>n</cite> steps.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.double">
<tt class="descname">double</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.double" title="Permalink to this definition">¶</a></dt>
<dd><p>Double the size of the model in each direction and initialize
larger model with current configuration in each copy.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.get_atoms">
<tt class="descname">get_atoms</tt><big>(</big><em>geometry=True</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.get_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ASE Atoms object with additional
information such as coverage and Turn-over-frequencies
attached.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.get_occupation_header">
<tt class="descname">get_occupation_header</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.get_occupation_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the names of the fields returned by
self.get_atoms().occupation.
Useful for the header line of an ASCII output.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.get_tof_header">
<tt class="descname">get_tof_header</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.get_tof_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the names of the fields returned by
self.get_atoms().tof_data.
Useful for the header line of an ASCII output.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.halve">
<tt class="descname">halve</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.halve" title="Permalink to this definition">¶</a></dt>
<dd><p>Halve the size of the model and initialize each site in the new model
with a species randomly drawn from the sites that are reduced onto
one. It is necessary that the simulation size is even</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.post_mortem">
<tt class="descname">post_mortem</tt><big>(</big><em>steps=None</em>, <em>propagate=False</em>, <em>err_code=None</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.post_mortem" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts an integer and generates a post-mortem report
by running that many steps and returning which process
would be executed next without executing it.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.put">
<tt class="descname">put</tt><big>(</big><em>site</em>, <em>species</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Puts a certain species at a certain site.
(Not implemented)</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.run">
<tt class="descname">run</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the model indefinitely. To control the
simulations, model must have been initialized
with proper Queues.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.start">
<tt class="descname">start</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start child process</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.view">
<tt class="descname">view</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the current configuration of the model using ASE ag.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model.xml">
<tt class="descname">xml</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model.xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the XML representation that this model was created from.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model._get_configuration">
<tt class="descname">_get_configuration</tt><big>(</big><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model._get_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current configuration of model.</p>
</dd></dl>

<dl class="method">
<dt id="kmos.run.KMC_Model._set_configuration">
<tt class="descname">_set_configuration</tt><big>(</big><em>config</em><big>)</big><a class="headerlink" href="#kmos.run.KMC_Model._set_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the current lattice configuration.</p>
<p>Expects a 4-dimensional array, with dimensions [X, Y, Z, N]
where X, Y, Z are the lattice size and N the number of
sites in each unit cell.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-kmos.view">
<span id="kmos-view"></span><h3>kmos.view<a class="headerlink" href="#module-kmos.view" title="Permalink to this headline">¶</a></h3>
<p>Run and view a kMC model. For this to work one needs a
kmc_model.so and a kmc_settings.py in the import path.</p>
<dl class="class">
<dt id="kmos.view.KMC_Viewer">
<em class="property">class </em><tt class="descclassname">kmos.view.</tt><tt class="descname">KMC_Viewer</tt><big>(</big><em>model=None</em><big>)</big><a class="headerlink" href="#kmos.view.KMC_Viewer" title="Permalink to this definition">¶</a></dt>
<dd><p>A graphical front-end to run, manipulate
and view a kMC model.</p>
</dd></dl>

</div>
</div>
<div class="section" id="kmos-kmc-project-dtd">
<h2>kmos kMC project DTD<a class="headerlink" href="#kmos-kmc-project-dtd" title="Permalink to this headline">¶</a></h2>
<p>The central storage and exchange format is XML. XML was chosen over
JSON, pickle or alike because it still seems as the most flexible
and universal format with good methods to define the overall
structure of the data.</p>
<p>One way to define an XML format is by using a document type description
(DTD) and in fact at every import a kmos file is validated against
the DTD below.</p>
<div class="highlight-python"><pre>&lt;!ELEMENT kmc (meta?,species_list?,parameter_list?, lattice, process_list?,output_list?)&gt;
  &lt;!ATTLIST kmc
  version CDATA #REQUIRED
  &gt;
  &lt;!ELEMENT meta EMPTY&gt;
  &lt;!ATTLIST meta
    author CDATA #IMPLIED
    debug CDATA #IMPLIED
    email CDATA #IMPLIED
    model_dimension CDATA #IMPLIED
    model_name CDATA #IMPLIED
  &gt;

  &lt;!ELEMENT species_list (species)*&gt;
  &lt;!ATTLIST species_list
    default_species CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT species EMPTY&gt;
  &lt;!ATTLIST species
    name CDATA #REQUIRED
    color CDATA #IMPLIED
    representation CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT parameter_list (parameter)*&gt;
  &lt;!ELEMENT parameter EMPTY&gt;
  &lt;!ATTLIST parameter
    name CDATA #REQUIRED
    value CDATA #IMPLIED
    adjustable CDATA #IMPLIED
    min CDATA #IMPLIED
    max CDATA #IMPLIED
    scale CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT lattice (layer)*&gt;
  &lt;!ATTLIST lattice
    cell_size CDATA #REQUIRED
    default_layer CDATA #REQUIRED
    substrate_layer CDATA #IMPLIED
    representation CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT layer (site)*&gt;
  &lt;!ATTLIST layer
    name CDATA #REQUIRED
    grid CDATA #IMPLIED
    grid_offset CDATA #IMPLIED
    color CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT site EMPTY&gt;
  &lt;!ATTLIST site
    pos CDATA #REQUIRED
    type CDATA #REQUIRED
    tags CDATA #IMPLIED
    default_species CDATA #IMPLIED
  &gt;
  &lt;!ELEMENT process_list (process)*&gt;
    &lt;!ELEMENT process (condition|action)*&gt;
      &lt;!ATTLIST process
        name CDATA #REQUIRED
        rate_constant CDATA #REQUIRED
        enabled CDATA #IMPLIED
        tof_count CDATA #IMPLIED
      &gt;
      &lt;!ELEMENT condition EMPTY&gt;
      &lt;!ATTLIST condition
        coord_name CDATA #REQUIRED
        coord_layer CDATA #REQUIRED
        coord_offset CDATA #REQUIRED
        species CDATA #REQUIRED
      &gt;
      &lt;!ELEMENT action EMPTY&gt;
      &lt;!ATTLIST action
        coord_name CDATA #REQUIRED
        coord_layer CDATA #REQUIRED
        coord_offset CDATA #REQUIRED
        species CDATA #REQUIRED
      &gt;
      &lt;!ELEMENT output_list (output)*&gt;
        &lt;!ELEMENT output EMPTY&gt;
        &lt;!ATTLIST output
          item CDATA #REQUIRED
        &gt;
</pre>
</div>
</div>
<div class="section" id="backend">
<h2>Backend<a class="headerlink" href="#backend" title="Permalink to this headline">¶</a></h2>
<p>In general the backend includes all functions that are implemented in Fortran90,
which therefore should not have to be changed by hand often. The backend is
divided into three modules, which import each other in the following way</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">base</span> <span class="o">&lt;-</span> <span class="n">lattice</span> <span class="o">&lt;-</span> <span class="n">proclist</span>
</pre></div>
</div>
<p>The key for this division is reusability of the code. The <cite>base</cite> module
implement all aspects of the kMC code, which do not depend on the described
model. Thus it &#8220;never&#8221; has to change. The <cite>latttice</cite> module basically
repeats all methods of the <cite>base</cite> model in terms of lattice coordinates.
Thus the <cite>lattice</cite> module only changes, when the geometry of the model
changes, <em>e.g.</em> when you add or delete sites.
The <cite>proclist</cite> module implements the process list, that is the species
or states each site can have and the elementary steps. Typically that
changes most often while developing a model.</p>
<p>The rate constants and physical parameters of the system are not implemented
in the backend at all, since in the physical sense they are too high-level
to justify encoding and compilation at the Fortran level and so they
are typical read and parsed from a python script.</p>
<p>The <cite>kmos.run.KMC_Model</cite> class implements a convenient interface for most of
these functions, however all public methods (in Fortran called subroutines)
and variables can also be accessed directly like so</p>
<div class="highlight-python"><pre>from kmos.run import KMC_Model
model = KMC_Model(print_rates=False, banner=False)
model.base.&lt;TAB&gt;
model.lattice.&lt;TAB&gt;
model.proclist.&lt;TAB&gt;</pre>
</div>
<p>which works best in conjunction with <a class="reference external" href="ipython.org">ipython</a>.</p>
<div class="section" id="kmos-base">
<h3>kmos/base<a class="headerlink" href="#kmos-base" title="Permalink to this headline">¶</a></h3>
<blockquote>
<p>The base kMC module, which implements the kMC method on a <img class="math" src="../_images/math/ad2990977902054f4d1da49fba330ce8139e7859.png" alt="d = 1"/>
lattice. Virtually any lattice kMC model can be build on top of this.
The methods offered are:</p>
<ul class="simple">
<li>de/allocation of memory</li>
<li>book-keeping of the lattice configuration and all available processes</li>
<li>updating and tracking kMC time, kMC step and wall time</li>
<li>saving and reloading the current state</li>
<li>determine the process and site to be executed</li>
</ul>
</blockquote>
<div class="section" id="base-accum-rates">
<h4>base/accum_rates<a class="headerlink" href="#base-accum-rates" title="Permalink to this headline">¶</a></h4>
<blockquote>
Stores the accumulated rate constant multiplied with the number
of sites available for that process to be used by determine_procsite.
Let <img class="math" src="../_images/math/99d7255ca41810aba9f5362e728b6f33b554a99a.png" alt="\mathbf{c}"/> be the rate constants <img class="math" src="../_images/math/0cf40500c62874887969d031e32be4bfc7a9c519.png" alt="\mathbf{n}"/>
the number of available sites, and <img class="math" src="../_images/math/ccdc38a57634fa01ff9c2731a2fd899b258aee5a.png" alt="\mathbf{a}"/>
the accumulated rates, then <img class="math" src="../_images/math/2a772bd794fbedb2976268c491686644aefc02e8.png" alt="a_{i}"/>
is calculated according to <img class="math" src="../_images/math/1b8fe9a6c46b65b4c2355dfc5a4d35c3c3405eb5.png" alt="a_{i}=\sum_{j=1}^{i} c_{j} n_{j}"/>.</blockquote>
</div>
<div class="section" id="base-add-proc">
<h4>base/add_proc<a class="headerlink" href="#base-add-proc" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>The main idea of this subroutine is described in del_proc. Adding one
process to one capability is programmatically simpler since we can just
add it to the end of the respective array in avail_sites.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> positive integer number that represents the process to be added.</li>
<li><tt class="docutils literal"><span class="pre">site</span></tt> positive integer number that represents the site to be manipulated</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-allocate-system">
<h4>base/allocate_system<a class="headerlink" href="#base-allocate-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Allocates all book-keeping structures and stores
local copies of system name and size(s):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">systen_name</span></tt> identifier of this simulation, used as name of punch file</li>
<li><tt class="docutils literal"><span class="pre">volume</span></tt> the total number of sites</li>
<li><tt class="docutils literal"><span class="pre">nr_of_proc</span></tt> the total number of processes</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-assertion-fail">
<h4>base/assertion_fail<a class="headerlink" href="#base-assertion-fail" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Function that shall be used by all parts of the program to print a
proper message in case some assertion fails.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt> condition that is supposed to hold true</li>
<li><tt class="docutils literal"><span class="pre">r</span></tt> message that is printed to the poor user in case it fails</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-avail-sites">
<h4>base/avail_sites<a class="headerlink" href="#base-avail-sites" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Main book-keeping array that stores for each process the sites
that are available and for each site the address
in this very array. The meaning of the fields are:</p>
<blockquote>
avail_sites(proc, field, switch)</blockquote>
<p>where:</p>
<ul class="simple">
<li>proc &#8211; refers to a process in the process list</li>
<li>the field within the process, but the meaning differs as explained
under &#8216;switch&#8217;</li>
<li>switch &#8211; can be either 1 or 2 and switches between
(1) the actual numbers of the sites, which are available
and filled in from the left but in whatever order they come
or (2) the location where the site is stored in (1).</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-can-do">
<h4>base/can_do<a class="headerlink" href="#base-can-do" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Returns true if &#8216;site&#8217; can do &#8216;proc&#8217; right now</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> integer representing the requested process.</li>
<li><tt class="docutils literal"><span class="pre">site</span></tt> integer representing the requested site.</li>
<li><tt class="docutils literal"><span class="pre">can</span></tt> writeable boolean, where the result will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-deallocate-system">
<h4>base/deallocate_system<a class="headerlink" href="#base-deallocate-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Deallocate all allocatable arrays: avail_sites, lattice, rates,
accum_rates, procstat.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="base-del-proc">
<h4>base/del_proc<a class="headerlink" href="#base-del-proc" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>del_proc delete one process from the main book-keeping array
avail_sites. These book-keeping operations happen in O(1) time with the
help of some more book-keeping overhead. avail_sites stores for each
process all sites that are available. The array for each process is
filled from the left, but sites generally not ordered. With this
determine_procsite can effectively pick the next site and process. On
the other hand a second array (avail_sites(:,:,2) ) holds for each
process and each site, the location where it is stored in
avail_site(:,:,1). If a site needs to be removed this subroutine first
looks up the location via avail_sites(:,:,1) and replaces it with the
site that is stored as the last element for this process.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> positive integer that states the process</li>
<li><tt class="docutils literal"><span class="pre">site</span></tt> positive integer that encodes the site to be manipulated</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-determine-procsite">
<h4>base/determine_procsite<a class="headerlink" href="#base-determine-procsite" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Expects two random numbers between 0 and 1 and determines the
corresponding process and site from accum_rates and avail_sites.
Technically one random number would be sufficient but to circumvent
issues with wrong interval_search_real implementation or rounding
errors I decided to take two random numbers:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ran_proc</span></tt> Random real number from <img class="math" src="../_images/math/ad1f4f4523e3a6994e94149f5cdbf296a9792988.png" alt="\in[0,1]"/> that selects the next process</li>
<li><tt class="docutils literal"><span class="pre">ran_site</span></tt> Random real number from <img class="math" src="../_images/math/ad1f4f4523e3a6994e94149f5cdbf296a9792988.png" alt="\in[0,1]"/> that selects the next site</li>
<li><tt class="docutils literal"><span class="pre">proc</span></tt> Return integer <img class="math" src="../_images/math/7dd31598a28f815ed315ae04c33be13bff425c89.png" alt="\in[1,\mathrm{nr\_of\_proc}"/></li>
<li><tt class="docutils literal"><span class="pre">site</span></tt> Return integer <img class="math" src="../_images/math/b44913112a2ced975e7f9079232454a9b9b7b102.png" alt="\in [1,\mathrm{volume}"/></li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-kmc-step">
<h4>base/get_kmc_step<a class="headerlink" href="#base-get-kmc-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return the current kmc_step</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">kmc_step</span></tt> Writeable integer</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-kmc-time">
<h4>base/get_kmc_time<a class="headerlink" href="#base-get-kmc-time" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Returns current kmc_time as rdouble real as defined in kind_values.f90.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">return_kmc_time</span></tt> writeable real, where the kmc_time will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-kmc-time-step">
<h4>base/get_kmc_time_step<a class="headerlink" href="#base-get-kmc-time-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Returns current kmc_time_step (the time increment).</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">return_kmc_step</span></tt> writeable real, where the kmc_time_step will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-kmc-volume">
<h4>base/get_kmc_volume<a class="headerlink" href="#base-get-kmc-volume" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return the total number of sites.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">volume</span></tt> Writeable integer.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-nrofsites">
<h4>base/get_nrofsites<a class="headerlink" href="#base-get-nrofsites" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return how many sites are available for a certain process.
Usually used for debugging</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> integer  representing the requested process</li>
<li><tt class="docutils literal"><span class="pre">return_nrofsites</span></tt> writeable integer, where nr of sites gets stored</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-procstat">
<h4>base/get_procstat<a class="headerlink" href="#base-get-procstat" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return process counter for process proc as integer.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> integer representing the requested process.</li>
<li><tt class="docutils literal"><span class="pre">return_procstat</span></tt> writeable integer, where the process counter will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-rate">
<h4>base/get_rate<a class="headerlink" href="#base-get-rate" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return rate of given process.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc_nr</span></tt> integer representing the requested process.</li>
<li><tt class="docutils literal"><span class="pre">return_rate</span></tt> writeable real, where the requested rate will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-species">
<h4>base/get_species<a class="headerlink" href="#base-get-species" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return the species that occupies site.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">site</span></tt> integer representing the site</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-system-name">
<h4>base/get_system_name<a class="headerlink" href="#base-get-system-name" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Returns the systems name, that was specified with base/allocate_system</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">system_name</span></tt> Writeable string of type character(len=200).</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-get-walltime">
<h4>base/get_walltime<a class="headerlink" href="#base-get-walltime" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Return the current walltime.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">return_walltime</span></tt> writeable real where the walltime will be stored.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-increment-procstat">
<h4>base/increment_procstat<a class="headerlink" href="#base-increment-procstat" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Increment the process counter for process proc by one.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> integer representing the process to be increment.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-interval-search-real">
<h4>base/interval_search_real<a class="headerlink" href="#base-interval-search-real" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>This is basically a standard binary search algorithm that expects an array
of ascending real numbers and a scalar real and return the key of the
corresponding field, with the following modification :</p>
<ul class="simple">
<li>the value of the returned field is equal of larger of the given
value. This is important because the given value is between 0 and the
largest value in the array and otherwise the last field is never
selected.</li>
<li>if two or more values in the array are identical, the function
return the index of the leftmost of those field. This is important
because having field with identical values means that all field except
the leftmost one do not contain any sites. Refer to
update_accum_rate to understand why.</li>
<li>the value of the returned field may no be zero. Therefore the index
the to be equal or larger than the first non-zero field.</li>
</ul>
<p>However: as everyone knows the binary search is trickier than it appears
at first site especially real numbers. So intensive testing is
suggested here!</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">arr</span></tt> real array of type rsingle (kind_values.f90) in monotonically (not strictly) increasing order</li>
<li><tt class="docutils literal"><span class="pre">value</span></tt> real positive number from [0, max_arr_value]</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-kmc-step">
<h4>base/kmc_step<a class="headerlink" href="#base-kmc-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
Number of kMC steps executed.</blockquote>
</div>
<div class="section" id="base-kmc-time">
<h4>base/kmc_time<a class="headerlink" href="#base-kmc-time" title="Permalink to this headline">¶</a></h4>
<blockquote>
Simulated kMC time in this run in seconds.</blockquote>
</div>
<div class="section" id="base-kmc-time-step">
<h4>base/kmc_time_step<a class="headerlink" href="#base-kmc-time-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
The time increment of the current kMC step.</blockquote>
</div>
<div class="section" id="base-lattice">
<h4>base/lattice<a class="headerlink" href="#base-lattice" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Stores the actual physical lattice in a 1d array, where the value
on each slot represents the species on that site.</p>
<p>Species constants can be conveniently defined
in lattice_... and later used directly in the process list.</p>
</blockquote>
</div>
<div class="section" id="base-nr-of-proc">
<h4>base/nr_of_proc<a class="headerlink" href="#base-nr-of-proc" title="Permalink to this headline">¶</a></h4>
<blockquote>
Total number of available processes.</blockquote>
</div>
<div class="section" id="base-nr-of-sites">
<h4>base/nr_of_sites<a class="headerlink" href="#base-nr-of-sites" title="Permalink to this headline">¶</a></h4>
<blockquote>
Stores the number of sites available for each process.</blockquote>
</div>
<div class="section" id="base-procstat">
<h4>base/procstat<a class="headerlink" href="#base-procstat" title="Permalink to this headline">¶</a></h4>
<blockquote>
Stores the total number of times each process has been executed
during one simulation.</blockquote>
</div>
<div class="section" id="base-rates">
<h4>base/rates<a class="headerlink" href="#base-rates" title="Permalink to this headline">¶</a></h4>
<blockquote>
Stores the rate constants for each process in s^-1.</blockquote>
</div>
<div class="section" id="base-reload-system">
<h4>base/reload_system<a class="headerlink" href="#base-reload-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Restore state of simulation from *.reload file as saved by
save_system(). This function also allocates the system&#8217;s memory
so calling allocate_system again, will cause a runtime failure.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">system_name</span></tt> string of 200 characters which will make the reload_system look for a file called ./&lt;system_name&gt;.reload</li>
<li><tt class="docutils literal"><span class="pre">reloaded</span></tt> logical return variable, that is .true. reload of system could be completed successfully, and .false. otherwise.</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-replace-species">
<h4>base/replace_species<a class="headerlink" href="#base-replace-species" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Replaces the species at a given site with new_species, given
that old_species is correct, i.e. identical to the site that
is already there.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">site</span></tt> integer representing the site</li>
<li><tt class="docutils literal"><span class="pre">old_species</span></tt> integer representing the species to be removed</li>
<li><tt class="docutils literal"><span class="pre">new_species</span></tt> integer representing the species to be placed</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-reset-site">
<h4>base/reset_site<a class="headerlink" href="#base-reset-site" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>This function is a higher-level function to reset a site
as if it never existed. To achieve this the species
is set to null_species and all available processes
are stripped from the site via del_proc.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">site</span></tt> integer representing the requested site.</li>
<li><tt class="docutils literal"><span class="pre">species</span></tt> integer representing the species that ought to be at the site, for consistency checks</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-save-system">
<h4>base/save_system<a class="headerlink" href="#base-save-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>save_system stores the entire system information in a simple ASCII
filed names &lt;system_name&gt;.reload. All fields except avail_sites are
stored in the simple scheme:</p>
<blockquote>
variable value</blockquote>
<p>In the case of array variables, multiple values are seperated by one or
more spaces, and the record is terminated with a newline. The variable
avail_sites is treated slightly differently, since printed on a single
line it is almost impossible to interpret from the ASCII files. Instead
each process starts a new line, and the first number on the line stands
for the process number and the remaining fields, hold the values.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="base-set-kmc-time">
<h4>base/set_kmc_time<a class="headerlink" href="#base-set-kmc-time" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Sets current kmc_time as rdouble real as defined in kind_values.f90.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">new</span></tt> readable real, that the kmc time will be set to</li>
</ul>
</blockquote>
</div>
<div class="section" id="base-set-rate-const">
<h4>base/set_rate_const<a class="headerlink" href="#base-set-rate-const" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Allows to set the rate constant of the process with the number proc_nr.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc_n</span></tt> The process number as defined in the corresponding proclist_ module.</li>
<li><tt class="docutils literal"><span class="pre">rate</span></tt> the rate in <img class="math" src="../_images/math/9555c802aeda3db5e8b95b5ca081de42cd651cd2.png" alt="s^{-1}"/></li>
</ul>
</blockquote>
</div>
<div class="section" id="base-start-time">
<h4>base/start_time<a class="headerlink" href="#base-start-time" title="Permalink to this headline">¶</a></h4>
<blockquote>
CPU time spent in simulation at least reload.</blockquote>
</div>
<div class="section" id="base-system-name">
<h4>base/system_name<a class="headerlink" href="#base-system-name" title="Permalink to this headline">¶</a></h4>
<blockquote>
Unique indentifier of this simulation to be used for restart files.
This name should not contain any characters that you don&#8217;t want to
have in a filename either, i.e. only [A-Za-z0-9_-].</blockquote>
</div>
<div class="section" id="base-update-accum-rate">
<h4>base/update_accum_rate<a class="headerlink" href="#base-update-accum-rate" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Updates the vector of accum_rates.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="base-update-clocks">
<h4>base/update_clocks<a class="headerlink" href="#base-update-clocks" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Updates walltime, kmc_step and kmc_time.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ran_time</span></tt> Random real number <img class="math" src="../_images/math/5a8fb07940437396dd240303860b93950e70ce3d.png" alt="\in [0,1]"/></li>
</ul>
</blockquote>
</div>
<div class="section" id="base-volume">
<h4>base/volume<a class="headerlink" href="#base-volume" title="Permalink to this headline">¶</a></h4>
<blockquote>
Total number of sites.</blockquote>
</div>
<div class="section" id="base-walltime">
<h4>base/walltime<a class="headerlink" href="#base-walltime" title="Permalink to this headline">¶</a></h4>
<blockquote>
Total CPU time spent on this simulation.</blockquote>
</div>
</div>
<div class="section" id="kmos-lattice">
<h3>kmos/lattice<a class="headerlink" href="#kmos-lattice" title="Permalink to this headline">¶</a></h3>
<blockquote>
Implements the mappings between the real space lattice
and the 1-D lattice, which kmos/base operates on.
Furthermore replicates all geometry specific functions of kmos/base
in terms of lattice coordinates.
Using this module each site can be addressed with 4-tuple
<tt class="docutils literal"><span class="pre">(i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">n)</span></tt> where <tt class="docutils literal"><span class="pre">i,</span> <span class="pre">j,</span> <span class="pre">k</span></tt> define the unit cell and
<tt class="docutils literal"><span class="pre">n</span></tt> the site within the unit cell.</blockquote>
<div class="section" id="lattice-allocate-system">
<h4>lattice/allocate_system<a class="headerlink" href="#lattice-allocate-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Allocates system, fills mapping cache, and
checks whether mapping is consistent</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="lattice-calculate-lattice2nr">
<h4>lattice/calculate_lattice2nr<a class="headerlink" href="#lattice-calculate-lattice2nr" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Maps all lattice coordinates onto a continuous
set of integer <img class="math" src="../_images/math/be7459e2d0b8d4daf6242fc283f26a20d9d23c75.png" alt="\in [1,volume]"/></p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">site</span></tt> integer array of size (4) a lattice coordinate</li>
</ul>
</blockquote>
</div>
<div class="section" id="lattice-calculate-nr2lattice">
<h4>lattice/calculate_nr2lattice<a class="headerlink" href="#lattice-calculate-nr2lattice" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Maps a continuous set of
of integers <img class="math" src="../_images/math/be7459e2d0b8d4daf6242fc283f26a20d9d23c75.png" alt="\in [1,volume]"/> to a
4-tuple representing a lattice coordinate</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">nr</span></tt> integer representing the site index</li>
</ul>
</blockquote>
</div>
<div class="section" id="lattice-deallocate-system">
<h4>lattice/deallocate_system<a class="headerlink" href="#lattice-deallocate-system" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Deallocates system including mapping cache.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
</div>
<div class="section" id="kmos-proclist">
<h3>kmos/proclist<a class="headerlink" href="#kmos-proclist" title="Permalink to this headline">¶</a></h3>
<blockquote>
Implements the kMC process list.</blockquote>
<div class="section" id="proclist-do-kmc-step">
<h4>proclist/do_kmc_step<a class="headerlink" href="#proclist-do-kmc-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Performs exactly one kMC step.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="proclist-get-kmc-step">
<h4>proclist/get_kmc_step<a class="headerlink" href="#proclist-get-kmc-step" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Determines next step without executing it.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="proclist-get-occupation">
<h4>proclist/get_occupation<a class="headerlink" href="#proclist-get-occupation" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Evaluate current lattice configuration and returns
the normalized occupation as matrix. Different species
run along the first axis and different sites run
along the second.</p>
<p><tt class="docutils literal"><span class="pre">none</span></tt></p>
</blockquote>
</div>
<div class="section" id="proclist-init">
<h4>proclist/init<a class="headerlink" href="#proclist-init" title="Permalink to this headline">¶</a></h4>
<blockquote>
<blockquote>
Allocates the system and initializes all sites in the given
layer.</blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">input_system_size</span></tt> number of unit cell per axis.</li>
<li><tt class="docutils literal"><span class="pre">system_name</span></tt> identifier for reload file.</li>
<li><tt class="docutils literal"><span class="pre">layer</span></tt> initial layer.</li>
<li><tt class="docutils literal"><span class="pre">no_banner</span></tt> [optional] if True no copyright is issued.</li>
</ul>
</blockquote>
</div>
<div class="section" id="proclist-initialize-state">
<h4>proclist/initialize_state<a class="headerlink" href="#proclist-initialize-state" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Initialize all sites and book-keeping array
for the given layer.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">layer</span></tt> integer representing layer</li>
</ul>
</blockquote>
</div>
<div class="section" id="proclist-run-proc-nr">
<h4>proclist/run_proc_nr<a class="headerlink" href="#proclist-run-proc-nr" title="Permalink to this headline">¶</a></h4>
<blockquote>
<p>Runs process <tt class="docutils literal"><span class="pre">proc</span></tt> on site <tt class="docutils literal"><span class="pre">nr_site</span></tt>.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proc</span></tt> integer representing the process number</li>
<li><tt class="docutils literal"><span class="pre">nr_site</span></tt>  integer representing the site</li>
</ul>
</blockquote>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../troubleshooting/index.html" title="Trouble Shooting"
             >next</a> |</li>
        <li class="right" >
          <a href="../topic_guides/coord_syntax.html" title="The Site/Coordinate Syntax"
             >previous</a> |</li>
        <li><a href="../index.html">kmos v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2012, Max J. Hoffmann.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>